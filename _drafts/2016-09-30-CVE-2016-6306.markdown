---
layout: post
title:  "CVE-2016-6306 - OpenSSL の証明書のパーサにおけるサービス運用妨害 (DoS) の脆弱性"
date:   2016-09-30 18:00:00 +0900
categories: vlunerability
toc: true
---

# CVE-2016-6306

## 概要

ssl3_get_client_certificate, ssl3_gets_server_certificate, ssl3_get_certificate_requestにはメッセージの長さのチェックに幾つか欠陥があるための、割り当てられたバッファを超えて最大2バイトを読み込もうとする脆弱性があります。この脆弱性は理論的な概念のみに基づいており、共通のプラットフォーム上で実際に検証されているわけではありません。

OpenSSL 1.1.0 is not affected.

OpenSSL 1.0.2 users should upgrade to 1.0.2i
OpenSSL 1.0.1 users should upgrade to 1.0.1u

This issue was reported to OpenSSL on 22nd August 2016 by Shi Lei (Gear Team,
Qihoo 360 Inc.). The fix was developed by Stephen Henson of the OpenSSL
development team.

Excessive allocation of memory in tls_get_message_header() (CVE-2016-6307)
```

```
重大度：低

OpenSSLの1.0.2以前では、一部欠落しているメッセージの長さのチェックがもたらすことができます
OOBは、割り当てられたバッファを越えて最大2バイトの読み込みます。理論があります
DoS攻撃のリスクが、これは、共通のプラットフォーム上で、実際に観察されていません。

影響を受けたメッセージは、クライアント証明書、クライアント証明書要求され
サーバー証明書。その結果、攻撃はに対してのみ行うことができます
クライアントまたはクライアント認証が可能になり、サーバ。

OpenSSLの1.1.0には影響はありません。

OpenSSLは、ユーザーが1.0.2iにアップグレードする必要があります1.0.2
OpenSSLは、ユーザーが1.0.1uにアップグレードする必要があります1.0.1

この問題は、市レイによって2016年8月22日（ギアチームにはOpenSSLに報告されました
Qihooは360社）。修正プログラムは、OpenSSLのスティーブン・ヘンソンによって開発されました
開発チーム。

tls_get_message_headerのメモリの過剰割り当て（）（CVE-2016から6307）
```

## CVSS v3

|CVSS v3 Base Score|5.9 Medium|
|Vector|CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H|
|Impact Score| 3.6|
|Exploitability Score| 2.2|
|Attack Vector (AV)| Network|
|Attack Complexity (AC)| High|
|Privileges Required (PR)| None|
|User Interaction (UI)| None|
|Scope (S)| Unchanged|
|Confidentiality (C)| None|
|Integrity (I)| None|
|Availability (A)| High|

## 解決策、緩和策情報

OpenSSL 1.0.2のユーザはOpenSSL1.0.2iにアップグレードしてください。
OpenSSL 1.0.1のユーザはOpenSSL1.0.1uにアップグレードしてください。

## 影響を受けるソフトウェアとバージョン

 * openssl1.0.1s
 * openssl1.0.1t
 * openssl1.0.1
 * openssl1.0.1:beta1
 * openssl1.0.1:beta2
 * openssl1.0.1:beta3
 * openssl1.0.1a
 * openssl1.0.1b
 * openssl1.0.1c
 * openssl1.0.1d
 * openssl1.0.1e
 * openssl1.0.1f
 * openssl1.0.1g
 * openssl1.0.1h
 * openssl1.0.1i
 * openssl1.0.1j
 * openssl1.0.1k
 * openssl1.0.1l
 * openssl1.0.1m
 * openssl1.0.1n
 * openssl1.0.1o
 * openssl1.0.1p
 * openssl1.0.1q
 * openssl1.0.1r
 * openssl1.0.2
 * openssl1.0.2:beta1
 * openssl1.0.2:beta2
 * openssl1.0.2:beta3
 * openssl1.0.2a
 * openssl1.0.2b
 * openssl1.0.2c
 * openssl1.0.2d
 * openssl1.0.2e
 * openssl1.0.2f
 * openssl1.0.2h

## 追跡が必要な情報源

 * [CERT](https://www.kb.cert.org/vuls/byid?query=CVE-2016-6306&searchview=)
 * [Debian](https://security-tracker.debian.org/tracker/CVE-2016-6306)
 * [Github](https://github.com/search?q="CVE-2016-6306")
 * [LWN](https://lwn.net/Search/DoSearch?words=CVE-2016-6306)
 * [NVD](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-6306)
 * [PacketStorm](https://packetstormsecurity.com/search/?q=CVE-2016-6306)
 * [Redhat](https://access.redhat.com/security/cve/CVE-2016-6306)
 * [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2016-6306.html)
 * [bugtraq](https://marc.info/?s=CVE-2016-6306&l=bugtraq)
 * [bugzilla](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2016-6306)
 * [exploitdb](https://www.exploit-db.com/search/?action=search&cve=2016-6306)
 * [fulldisc](https://marc.info/?s=CVE-2016-6306&l=full-disclosure)
 * [metasploit](https://www.rapid7.com/db/search?q=CVE-2016-6306)
 * [oss-sec](https://marc.info/?s=CVE-2016-6306&l=oss-security)
 * [twitter](https://twitter.com/search?q=CVE-2016-6306)

# 参考文献

 * http://jvndb.jvn.jp/ja/contents/2016/JVNDB-2016-004992.html
 * https://www.openssl.org/news/secadv/20160922.txt
 * https://git.openssl.org/?p=openssl.git;a=commit;h=52e623c4cb06fffa9d5e75c60b34b4bc130b12e9


